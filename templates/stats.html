{% extends 'base.html' %}

{% block title %}Entre Linhas — Estatísticas{% endblock %}

{% block extra_head %}
<style>
  .stat-card {
    @apply bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 transition-all duration-300 hover:shadow-lg;
  }
  
  .stat-number {
    @apply text-4xl font-bold text-primary-600 dark:text-primary-400;
  }
  
  .stat-label {
    @apply text-sm text-gray-500 dark:text-gray-400 uppercase tracking-wider;
  }
  
  .category-stat {
    @apply flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700 last:border-b-0;
  }
</style>
{% endblock %}

{% block content %}
<div class="bg-gradient-to-b from-primary-600 to-primary-800 text-white py-12">
  <div class="container mx-auto px-6 text-center">
    <h1 class="text-4xl font-bold mb-4">Estatísticas da Comunidade</h1>
    <p class="text-xl opacity-90 max-w-2xl mx-auto">
      Dados anônimos sobre a atividade na plataforma Entre Linhas.
      Nenhuma informação pessoal é coletada ou exibida.
    </p>
  </div>
</div>

<div class="container mx-auto px-6 py-10">
  <!-- Resumo de estatísticas principais -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
    <div class="stat-card text-center">
      <p class="stat-label mb-2">Total de Desabafos</p>
      <p class="stat-number">{{ post_stats.total_posts }}</p>
      <p class="mt-3 text-gray-600 dark:text-gray-300">Desabafos compartilhados na plataforma</p>
    </div>
    
    <div class="stat-card text-center">
      <p class="stat-label mb-2">Total de Comentários</p>
      <p class="stat-number">{{ comment_stats.total_comments }}</p>
      <p class="mt-3 text-gray-600 dark:text-gray-300">Média de {{ "%.1f"|format(comment_stats.avg_comments) }} comentários por desabafo</p>
    </div>
    
    <div class="stat-card text-center">
      <p class="stat-label mb-2">Total de Reações</p>
      <p class="stat-number">{{ reaction_stats.total_reactions }}</p>
      <p class="mt-3 text-gray-600 dark:text-gray-300">Demonstrações de apoio e empatia</p>
    </div>
  </div>
  
  <!-- Estatísticas detalhadas -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
    <!-- Desabafos por categoria -->
    <div class="stat-card">
      <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-6">Desabafos por Categoria</h2>
      <div class="space-y-1">
        {% for category in post_stats.posts_by_category %}
          <div class="category-stat">
            <span class="text-gray-700 dark:text-gray-300 capitalize">{{ category.categoria }}</span>
            <span class="font-semibold text-primary-600 dark:text-primary-400">{{ category.count }}</span>
          </div>
        {% endfor %}
      </div>
    </div>
    
    <!-- Atividade por dia da semana -->
    <div class="stat-card">
      <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-6">Atividade por Dia da Semana</h2>
      <div class="space-y-1">
        {% for weekday in post_stats.posts_by_weekday %}
          <div class="category-stat">
            <span class="text-gray-700 dark:text-gray-300">{{ weekday.dia_semana }}</span>
            <span class="font-semibold text-primary-600 dark:text-primary-400">{{ weekday.count }}</span>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
  
  <!-- Desabafos mais comentados -->
  {% if comment_stats.most_commented_posts %}
  <div class="stat-card mb-10">
    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-6">Desabafos Mais Comentados</h2>
    <div class="space-y-4">
      {% for post in comment_stats.most_commented_posts %}
        <div class="border-l-4 border-primary-500 pl-4 py-2">
          <p class="text-gray-900 dark:text-gray-100 text-sm">{{ post.mensagem|truncate(120) }}</p>
          <div class="mt-2 flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">ID: #{{ post.id }}</span>
            <span class="text-sm font-semibold text-primary-600 dark:text-primary-400">{{ post.comment_count }} comentários</span>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
  
  <!-- Informações adicionais -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="stat-card">
      <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Sobre as Estatísticas</h3>
      <div class="text-sm text-gray-600 dark:text-gray-300 space-y-2">
        <p>• Todos os dados são completamente anônimos</p>
        <p>• Nenhuma informação pessoal é coletada</p>
        <p>• Estatísticas atualizadas em tempo real</p>
        <p>• Dados utilizados apenas para melhorar a plataforma</p>
      </div>
    </div>
    
    <div class="stat-card">
      <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Impacto da Comunidade</h3>
      <div class="text-sm text-gray-600 dark:text-gray-300 space-y-2">
        <p>• Espaço seguro para {{ post_stats.total_posts }} desabafos</p>
        <p>• {{ comment_stats.total_comments }} mensagens de apoio compartilhadas</p>
        <p>• {{ reaction_stats.total_reactions }} demonstrações de empatia</p>
        <p>• Comunidade crescendo a cada dia</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

